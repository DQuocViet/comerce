{% extends "base.html" %}

{% load static %}

{#    {% block ajax_create_resume %}#}
{#        <script src="{% static 'Page/create_resume.js' %}"></script>#}
{#    {% endblock %}#}
    {% block view_detail_jobapply %}
		<!--/Header Main-->
        <div>{% csrf_token %}</div>
            {% if user.is_authenticated %}
                <script> window.onload = get_profile()</script>
                {% if not user.employee %}
                    <script> window.location.href = "/jwtauth/checkfunc/"</script>
                {% endif %}
            {% else %}
                <script> window.location.href = "/account/login/"</script>
            {% endif %}
		<!--Sliders Section-->
		<section>
			<div class="bannerimg cover-image bg-background3" data-image-src="../assets/images/banners/banner2.jpg">
				<div class="header-text mb-0">
					<div class="container">
						<div class="text-center text-white">
							<h1>View Detail CurriculumVitae</h1>
							<ol class="breadcrumb text-center">
								<li class="breadcrumb-item"><a href="#">Home</a></li>
								<li class="breadcrumb-item"><a href="#">Pages</a></li>
								<li class="breadcrumb-item active text-white" aria-current="page">Create Job</li>
							</ol>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!--/Sliders Section-->

        {% block edit_profile_resume %}
		<!--Job posts-section-->
		<section class="sptb">
			<div class="container">
				<div class="row ">
                    {#show profile#}
                    {% block show_profile %}
					<div class="col-lg-8 col-md-12 col-md-12">
						<div class="card dropify-image-avatar" id="show_profile">
							<div class="card-header ">
								<h3 class="card-title">Personal Data</h3>
                                    <div class="card-options">
                                        <button  id="show_hide_profile" class="btn btn-light btn-sm" href="#"><i class="fa fa-edit"></i> Edit</button>
                                    </div>
							</div>
							<div class="card-body" id="show_profile1">
								<div class="row">
									<div class="col-lg-3 mb-4 mb-lg-0">
{#										<input type="file" class="dropify" data-default-file="../assets/images/users/avatar.png" data-height="180"/>#}
                                        <img src="" id="id_img" alt="error">
									</div>
									<div class="col-lg-9">
										<div class="row">
											<div class="col-md-6">
                                                <div class="form-group">
													<label class="tieude">Full Name: </label>
                                                    <label type="text" placeholder="User Full Name" required id="userfullname1"></label>
												</div>
                                                <div class="form-group">
													<label class="tieude">Email: </label>
                                                    <label type="email" placeholder="Email" required id="email1"></label>
												</div>
{#												<div class="form-group">#}
{#													<label class="form-label text-dark">User First Name: </label>#}
{#													<input type="text" class="form-control userfullname" placeholder="User First Name" required id="userfirtname1">#}
{#												</div>#}
{#												<div class="form-group">#}
{#													<label class="form-label text-dark">User Middle Name</label>#}
{#													<input type="text" class="form-control phonenumber" placeholder="User Middle Name" required id="usermiddlename1">#}
{#												</div>#}
{#												<div class="form-group">#}
{#													<label class="form-label text-dark">User Last Name</label>#}
{#													<input type="email" class="form-control city" placeholder="User Last Name" required id="userlastname1">#}
{#												</div>#}
                                                <div class="form-group">
													<label class="tieude">Phone: </label>
                                                    <label type="number" placeholder="User Phone" required id="userphone1"></label>
												</div>
											</div>
											<div class="col-md-6">
                                                <div class="form-group">
													<label class="tieude">Birth Day: </label>
                                                    <label type="date" placeholder="User Birth Day" required id="userbirthday1"></label>
												</div>
                                                <div class="form-group">
													<label class="tieude">Sex: </label>
                                                    <label type="text" placeholder="User Sex" required id="usersex1"></label>
												</div>
											</div>
                                            <div class="col-md-12">
                                                <div class="form-group">
													<label class="tieude" >Address: </label>
                                                    <label name="select_address_full" id="select_address_full2"></label>
												</div>
                                            </div>
										</div>
									</div>
								</div>
							</div>

						</div>
                        {# edit profile #}
{#                            <div class="card dropify-image-avatar" id="edit_profile">#}
                            <div class="card dropify-image-avatar" id="edit_profile">
							<div class="card-header">
								<h3 class="card-title">Edit Profile</h3>
							</div>
							<div class="card-body">
								<div class="row">
                                    <div class="col-md-6">
												<div class="form-group">
													<label class="form-label text-dark">User First Name </label>
													<input type="text" class="form-control userfullname" placeholder="User First Name" required id="userfirtname">
												</div>
												<div class="form-group">
													<label class="form-label text-dark">User Middle Name </label>
													<input type="text" class="form-control phonenumber" placeholder="User Middle Name" required id="usermiddlename">
												</div>
												<div class="form-group">
													<label class="form-label text-dark">User Last Name</label>
													<input type="email" class="form-control city" placeholder="User Last Name" required id="userlastname">
												</div>
                                                <div class="form-group">
													<label class="form-label text-dark">User Phone</label>
													<input type="number" class="form-control address" placeholder="User Phone" required id="userphone">
												</div>
											</div>
                                    <div class="col-md-6">
												<div class="form-group">
													<label class="form-label text-dark">User Full Name</label>
													<input type="text" class="form-control address" placeholder="User Full Name" required id="userfullname">
												</div>
                                                <div class="form-group">
													<label class="form-label text-dark">User Birth Day</label>
													<input type="date" class="form-control postalcode" placeholder="User Birth Day" required id="userbirtday">
												</div>
                                                <div class="form-group">
													<label class="form-label text-dark">User Sex</label>
													<input type="text" class="form-control desctiption" placeholder="User Sex" required id="usersex">
												</div>
                                                <div class="form-group">
													<label class="form-label text-dark">Email</label>
													<input type="email" class="form-control postalcode" placeholder="Email" required id="email">
												</div>
											</div>
{#                                    <div class="col-md-12">#}
{#                                        <label for="">Address</label>#}
{#                                        <div class="form-group">#}
{#                                                    <select name="select_address_full" class="form-control" id="select_address_full"></select>#}
{#                                                </div>#}
{#                                    </div>#}
                                    <img src="" alt="error" id="id_img1">
                                   <form id="avatar_form">
                                        <div>
                                            <label for="id_avatar">Choose an image for your avatar</label>
                                            <input type="file" class="form-control-file" id="id_avatar"/>
                                        </div>
                                        <button type="submit" id="upload_img">Upload</button>
                                   </form>
                                    {#///////////////////////////////////////  ajax upload image \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\#}
                                    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.min.js"></script>
                                    <script>
                                        $(document).ready(
                                                function() {
                                                    $("#edit_profile").hide();
                                                }
                                            );

                                        $(document).ready(function(){
                                            $("#show_hide_profile").click(function(){
                                                $("#edit_profile").show();
                                                $("#show_profile").hide();
                                            });});

                                        function reload_profile(){
                                            var container = document.getElementById("show_hide_profile");
                                            var content = container.innerHTML;
                                            container.innerHTML= content;

                                           //this line is to watch the result in console , you can remove it later
                                            console.log("Refreshed");
                                        }

                                        var URL_profile = "/connectdata/ProfileUserViewSet/";

                                        function readCookie(name) {
                                            var nameEQ = name + "=";
                                            var ca = document.cookie.split(';');
                                            for(var i=0;i < ca.length;i++) {
                                                var c = ca[i];
                                                while (c.charAt(0)==' ') c = c.substring(1,c.length);
                                                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
                                            }
                                            return null;
                                        }

                                        var csrftoken = readCookie('csrftoken');


                                        document.getElementById('avatar_form').addEventListener('submit', function(event) {
                                            event.preventDefault();
                                            let input = document.getElementById('id_avatar');
                                            let data = new FormData();
                                            data.append('UserImage', input.files[0]);
                                            console.log(data)
                                            var id_img = document.getElementById("upload_img").value;
                                            fetch('https://localhost:8000/jwtauth/ProfileUserViewSetToken/'+id_img+"/", {
                                                method: 'PUT',
                                                headers: {
                                                    "X-CSRFToken": csrftoken
                                                },
                                                body: data

                                                }).then(response => {
                                                    return response.json();
                                                }).then(data => {
                                                    console.log(data);
                                                    get_img()
                                                }).catch((error) => {
                                                    console.error('Error:', error);
                                                });
                                        });
                                    </script>
                                    {#/////////////////////////////////////// end ajax upload image \\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\#}
								</div>
							</div>
							<div class="card-footer">
                                <button type="submit" class="btn btn-primary" onclick="upload_profile()" id="upload_img">Updated Profile</button>
							</div>
						</div>
                            {# end edit profile #}
                        {#\\\\\\\\ create Jobs ///////#}
                        {#//////////////////////////////////// html add Jobs \\\\\\\\\\\\\\\\\\\\\\\\\\\\#}
                        <div class="card" >
							<div class="card-header" id="addJob">
								<h3 class="card-title">View detail jobs apply</h3>
                                <i class="card-options">(*)thông tin bắc buộc nhập</i>
							</div>
							<div class="card-body">
                                <table class="table">
{#                                    <thead>#}
{#                                        <tr>#}
{#                                          <th scope="col">Last</th>#}
{#                                          <th scope="col">Handle</th>#}
{#                                        </tr>#}
{#                                    </thead>#}
                                    <tbody>
                                        <tr>
                                          <td class="info_curr">Title: </td>
                                          <td class="info_cv_detail" id="Title"></td>
                                        </tr>
                                        <tr>
                                          <td class="info_curr">Introduce: </td>
                                          <td class="info_cv_detail" id="Introduce"></td>
                                        </tr>
                                        <tr>
                                          <td class="info_curr">Career: </td>
                                          <td class="info_cv_detail" id="Career"></td>
                                        </tr>
                                        <tr>
                                          <td class="info_curr">FormOfWork: </td>
                                          <td class="info_cv_detail" id="FormOfWork"></td>
                                        </tr>
                                        <tr>
                                          <td class="info_curr">WorkLocation: </td>
                                          <td class="info_cv_detail" id="WorkLocation"></td>
                                        </tr>
                                        <tr>
                                          <td class="info_curr">DesiredSalary: </td>
                                          <td class="info_cv_detail" id="DesiredSalary"></td>
                                        </tr>
                                        <tr>
                                          <td class="info_curr">MaritalStatus: </td>
                                          <td class="info_cv_detail" id="MaritalStatus"></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <br>
                                <br>
{#                                <div class="form-group">#}
{#									<label class="form-label text-dark">Title:#}
{#                                        <label type="text"  placeholder="Title" id="Title" required></label>#}
{#                                    </label>#}
{#								</div>#}
{#                                <div class="form-group">#}
{#									<label class="form-label text-dark">Introduce</label>#}
{#                                    <label type="text" placeholder="Introduce" id="Introduce" required></label>#}
{#								</div>#}
{#								<div class="form-group">#}
{#									<label class="form-label text-dark">Career</label>#}
{#									<label type="text" placeholder="Career" id="Career" required></label>#}
{#								</div>#}
{#                                <div class="form-group">#}
{#									<label class="form-label text-dark">FormOfWork</label>#}
{#									<label type="text" placeholder="FormOfWork" id="FormOfWork" required></label>#}
{#								</div>#}
{#								<div class="form-group">#}
{#									<label class="form-label text-dark">WorkLocation</label>#}
{#									<label type="text" placeholder="WorkLocation" id="WorkLocation" required></label>#}
{#								</div>#}
{#                                <div class="form-group">#}
{#									<label class="form-label text-dark">DesiredSalary</label>#}
{#									<label type="text" placeholder="DesiredSalary" id="DesiredSalary" required></label>#}
{#								</div>#}
{#                                <div class="form-group">#}
{#									<label class="form-label text-dark">MaritalStatus</label>#}
{#									<label type="text" placeholder="MaritalStatus" id="MaritalStatus" required></label>#}
{#								</div>#}
							</div>
						</div>
                        {#//////////////////////////////////// ajax add - detail - update Jobs \\\\\\\\\\\\\\\\\\\\\\\\\\\\#}
						<div class="float-right mb-4 mb-lg-0">
                            <button class="btn btn-secondary w-150" href="#" onclick="manage_no_apply({{ id_detail_job }})" id="btn_Finish">Refuse</button>
						</div>
                        <div class="float-right mb-4 mb-lg-0">
                            <button class="btn btn-primary w-150" href="#" onclick="manage_apply({{ id_detail_job }})" id="btn_Finish">Apply Job</button>
						</div>
					</div>
                    {% endblock %}
                    {#end show profile#}
                    <script>
                        var url_detail_applyjob = "/employer/EmployerJobApplyDetail/";
                        var url_detail_curr_applyjob = "/employee/GetCVetailView/";

                        function detail_applyjov() {
                            $.getJSON(url_detail_applyjob + {{ id_detail_job }} + "/",{},detail_applyjov1);
                        }
                        function detail_applyjov1(applyjob){
                            $.getJSON(url_detail_curr_applyjob + applyjob[0].CurriculumVitaeIDJobApply + "/",{},detail_applyjov2);
                        }
                        function detail_applyjov2(applyjob2){
                            $("#Title").text(applyjob2.Title)
                            $("#Introduce").text(applyjob2.Introduce)
                            $("#Career").text(applyjob2.Career)
                            $("#FormOfWork").text(applyjob2.FormOfWork)
                            $("#WorkLocation").text(applyjob2.WorkLocation)
                            $("#DesiredSalary").text(applyjob2.DesiredSalary)
                            $("#MaritalStatus").text(applyjob2.MaritalStatus)
                        }

                         var url_apply_comfim = "/employer/EmployerComfirmView/";
                        function manage_apply(id) {
                            var jsonarr_manage_apply = {
                                "Confirm": true,
                                };
                            console.log(JSON.stringify(jsonarr_manage_apply));

                            $.ajax({
                                "url": url_apply_comfim + id + "/",
                                "data": JSON.stringify(jsonarr_manage_apply),
                                "headers":{"X-CSRFToken": csrftoken},
                                "processData": false,
                                "contentType": 'application/json',
                                "type": "PUT",
                                "success": update_jsonarr_manage_apply_success1,
                                "error": update_Ejsonarr_manage_apply_error1
                            });
                        }
                        function update_jsonarr_manage_apply_success1(){
                            {#$.getJSON(URL_job_apply + {{ id_apply }} + "/",{},function (apply2) {#}
                            {#    for (var i = 0; i < apply2.length; i++)#}
                            {#    {#}
                            {#        document.getElementById(i+"apply_title_tr").remove()#}
                            {#    }#}
                            {#    get_jobs_apply();});#}
                            window.history.back();
                            alert("Apply Job success!")
                        }
                        function update_Ejsonarr_manage_apply_error1(){
                            alert("Apply error")
                        }

                        function manage_no_apply(id) {
                            var jsonarr_manage_apply = {
                                "Confirm": false,
                                };
                            console.log(JSON.stringify(jsonarr_manage_apply));

                            $.ajax({
                                "url": url_apply_comfim + id + "/",
                                "data": JSON.stringify(jsonarr_manage_apply),
                                "headers":{"X-CSRFToken": csrftoken},
                                "processData": false,
                                "contentType": 'application/json',
                                "type": "PUT",
                                "success": update_jsonarr_apply_success1,
                                "error": update_Ejsonarr_apply_error1
                            });
                        }
                        function update_jsonarr_apply_success1(){
                            window.history.back();
                            alert("Refuse")
                        }
                        function update_Ejsonarr_apply_error1(){
                            alert("Refuse false error")
                        }

                        window.onload = detail_applyjov();
                    </script>
					<div class="col-lg-4 col-md-12">
						<div class="card">
							<div class="card-header">
								<h3 class="card-title">Terms And Conditions</h3>
							</div>
							<div class="card-body">
								<ul class="list-unstyled widget-spec  mb-0">
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Money Not Refundable
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>You can renew your Premium ad after experted.
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium ads are active for depend on package.
									</li>
									<li class="ml-5 mb-0">
										<a href="tips.html"> View more..</a>
									</li>
								</ul>
							</div>
						</div>
						<div class="card">
							<div class="card-header">
								<h3 class="card-title">Benefits Of Premium Ad</h3>
							</div>
							<div class="card-body pb-2">
								<ul class="list-unstyled widget-spec vertical-scroll mb-0">
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium Ads Active
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium ads are displayed on top
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium ads will be Show in Google results
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium Ads Active
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium ads are displayed on top
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium ads will be Show in Google results
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium Ads Active
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium ads are displayed on top
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium ads will be Show in Google results
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium Ads Active
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium ads are displayed on top
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium ads will be Show in Google results
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium Ads Active
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium ads are displayed on top
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i>Premium ads will be Show in Google results
									</li>
								</ul>
							</div>
						</div>
						<div class="card mb-0">
							<div class="card-header">
								<h3 class="card-title">Safety Tips For Buyers</h3>
							</div>
							<div class="card-body">
								<ul class="list-unstyled widget-spec  mb-0">
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i> Meet Seller at public Place
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i> Check item before you buy
									</li>
									<li>
										<i class="fa fa-check text-success" aria-hidden="true"></i> Pay only after collecting item
									</li>
									<li class="ml-5 mb-0">
										<a href="tips.html"> View more..</a>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>
		<!--/Job posts-section-->
        {% endblock %}
		<!--Blogs-->
{% endblock %}
		<!--Blogs-->

		<!--Footer Section-->

		<!--Footer Section-->

		<!-- Notification -->
